package com.fubai.shennong.activity.listener;

//@CanalEventListener
public class CanalDataEventListener {
//    @ListenPoint(destination = "example", schema = "shennong", table = {"pd_store"},
//            eventType = {CanalEntry.EventType.UPDATE, CanalEntry.EventType.INSERT, CanalEntry.EventType.DELETE})
//    public void onEventCustomUpdateForTbUser(CanalEntry.EventType eventType, CanalEntry.RowData rowData) {
//        getChangeValue(eventType, rowData);
//    }
//
//    public static void getChangeValue(CanalEntry.EventType eventType, CanalEntry.RowData rowData) {
//        if (eventType == CanalEntry.EventType.DELETE) {
//            rowData.getBeforeColumnsList().forEach(column -> {
//                // 获取删除前的数据
//                System.out.println(column.getName() + " == " + column.getValue());
//            });
//        } else {
//            rowData.getBeforeColumnsList().forEach(column -> {
//                // 打印改变前的字段名和值
//                System.out.println(column.getName() + " == " + column.getValue());
//            });
//
//            rowData.getAfterColumnsList().forEach(column -> {
//                // 打印改变后的字段名和值
//                System.out.println(column.getName() + " == " + column.getValue());
//            });
//        }
//    }

}
